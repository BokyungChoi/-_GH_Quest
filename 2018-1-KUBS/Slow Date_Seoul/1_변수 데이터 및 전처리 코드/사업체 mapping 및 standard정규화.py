# -*- coding: utf-8 -*-
"""
Created on Thu Jun 14 18:25:58 2018

@author: BDI
"""

import pandas as pd

may_df = pd.read_excel("MAYtotal_standard.xls")
may_df.head()

#사업체종사자수/면적 변수 mapping
buss_dict = {'사직동': 40393.49593495935, '삼청동': 2494.6308724832215, '부암동': 1458.1497797356828, '평창동': 279.706877113867, '무악동': 3844.444444444445, '교남동': 9734.285714285716, '가회동': 24544.44444444444, '종로1.2.3.4가동': 42648.936170212764, '종로5·6가동': 35566.66666666667, '이화동': 18160.25641025641, '창신1동': 18196.774193548386, '창신2동': 8250.0, '창신3동': 3539.1304347826085, '숭인1동': 6317.391304347826, '숭인2동': 17754.285714285714, '청운효자동': 2215.5642023346304, '혜화동': 5899.999999999999, '소계': 5112.362749084994, '소공동': 61671.57894736843, '회현동': 58514.28571428572, '명동': 107546.46464646465, '필동': 19491.22807017544, '장충동': 5997.794117647059, '광희동': 47572.97297297297, '을지로동': 46660.0, '신당5동': 8730.76923076923, '황학동': 17490.909090909092, '중림동': 14643.75, '신당동': 48769.090909090904, '다산동': 17735.29411764706, '약수동': 6558.333333333334, '청구동': 10626.470588235294, '동화동': 14357.692307692307, '후암동': 5877.906976744186, '용산2가동': 792.3469387755102, '남영동': 13495.798319327732, '원효로2동': 9588.732394366198, '효창동': 4911.363636363636, '용문동': 4735.714285714285, '이촌1동': 1058.741258741259, '이촌2동': 621.3114754098361, '이태원1동': 8245.61403508772, '이태원2동': 2581.3953488372094, '서빙고동': 1730.357142857143, '보광동': 3346.478873239437, '청파동': 9141.758241758242, '원효로1동': 16069.49152542373, '한강로동': 10065.862068965518, '한남동': 4434.21926910299, '왕십리2동': 5500.0, '마장동': 10436.792452830188, '사근동': 8587.387387387387, '행당1동': 12496.610169491527, '행당2동': 4100.0, '응봉동': 1659.6491228070176, '금호1가동': 3319.565217391304, '금호4가동': 1852.3809523809525, '성수1가1동': 3763.131313131313, '성수1가2동': 18267.415730337078, '성수2가1동': 14815.254237288136, '성수2가3동': 43155.33980582524, '송정동': 3382.3529411764703, '용답동': 6233.189655172414, '왕십리도선동': 14763.888888888889, '금호2.3가동': 3626.5625, '옥수동': 1357.4358974358975, '화양동': 9398.275862068966, '군자동': 12048.648648648648, '중곡1동': 9608.064516129032, '중곡2동': 11232.727272727272, '중곡3동': 8553.333333333334, '중곡4동': 1869.3965517241381, '능동': 4876.363636363636, '구의1동': 9996.42857142857, '구의2동': 3351.7985611510794, '구의3동': 17731.37254901961, '광장동': 4176.569037656904, '자양1동': 13673.684210526317, '자양2동': 4253.571428571428, '자양3동': 4313.333333333334, '자양4동': 4399.137931034483, '회기동': 10932.894736842105, '휘경1동': 6192.063492063492, '휘경2동': 4500.0, '청량리동': 6068.333333333334, '용신동': 19177.639751552793, '제기동': 9240.677966101695, '전농1동': 5684.873949579832, '전농2동': 5116.279069767442, '답십리1동': 11972.839506172839, '답십리2동': 6600.0, '장안1동': 16129.6, '장안2동': 8824.770642201835, '이문1동': 5387.5, '이문2동': 2953.6231884057975, '면목2동': 8336.986301369863, '면목4동': 3074.7747747747744, '면목5동': 4357.8125, '면목7동': 4224.137931034483, '상봉1동': 6683.529411764706, '상봉2동': 11535.294117647058, '중화1동': 5104.411764705882, '중화2동': 6721.428571428572, '묵1동': 3877.5, '묵2동': 5935.714285714286, '망우3동': 3471.717171717172, '신내1동': 3618.9723320158105, '신내2동': 5744.444444444444, '면목본동': 6497.029702970297, '면목3.8동': 3677.8443113772455, '망우본동': 3873.263888888889, '돈암1동': 3451.0204081632655, '돈암2동': 4354.166666666667, '안암동': 8506.766917293233, '보문동': 8575.0, '정릉1동': 4009.090909090909, '정릉2동': 2146.153846153846, '정릉3동': 1044.4743935309973, '정릉4동': 1248.8817891373803, '길음1동': 3682.278481012658, '길음2동': 6996.551724137931, '월곡1동': 5662.962962962963, '월곡2동': 5102.2058823529405, '장위1동': 3448.571428571429, '장위2동': 6777.611940298507, '장위3동': 5063.076923076923, '성북동': 1545.1048951048951, '삼선동': 10339.130434782608, '동선동': 11591.780821917808, '종암동': 4411.643835616438, '석관동': 4967.052023121388, '번1동': 14299.999999999998, '번2동': 2540.8, '번3동': 3089.5348837209303, '수유1동': 4100.0, '수유2동': 5263.013698630137, '수유3동': 7560.46511627907, '삼양동': 3540.0, '미아동': 7334.246575342466, '송중동': 4895.081967213115, '송천동': 7121.590909090909, '삼각산동': 3261.2903225806454, '우이동': 277.07762557077626, '인수동': 1694.8805460750852, '쌍문1동': 2875.0, '쌍문2동': 9144.444444444443, '쌍문3동': 7288.0, '쌍문4동': 3407.6923076923076, '방학1동': 13968.115942028986, '방학2동': 3670.2702702702704, '방학3동': 1072.7272727272727, '창1동': 3745.4545454545455, '창2동': 3814.9532710280373, '창3동': 2877.6119402985073, '창4동': 6911.458333333334, '창5동': 8888.57142857143, '도봉1동': 595.9862385321101, '도봉2동': 7485.5421686746995, '월계1동': 4396.551724137931, '월계2동': 1597.4226804123712, '월계3동': 2691.4529914529917, '공릉2동': 1555.2785923753665, '하계1동': 4505.806451612903, '하계2동': 2252.9411764705883, '중계본동': 2406.5989847715737, '중계1동': 5744.444444444444, '중계4동': 1830.5882352941178, '상계1동': 1664.0569395017794, '상계2동': 12214.754098360656, '상계5동': 9727.272727272728, '상계8동': 2641.791044776119, '상계9동': 2853.0864197530864, '상계10동': 2573.75, '상계3.4동': 731.3167259786477, '상계6.7동': 11928.828828828828, '중계2.3동': 5005.555555555556, '공릉1동': 7183.687943262412, '녹번동': 5064.245810055866, '불광1동': 1711.5015974440896, '갈현1동': 3831.958762886598, '갈현2동': 5353.125, '구산동': 3568.840579710145, '대조동': 7732.941176470588, '응암1동': 5673.333333333334, '응암2동': 2082.0512820512818, '신사1동': 4110.714285714286, '신사2동': 3509.0, '증산동': 4669.135802469135, '수색동': 1896.8992248062016, '진관동': 602.601908065915, '불광2동': 2761.594202898551, '응암3동': 6409.523809523809, '역촌동': 6031.896551724139, '천연동': 2538.1443298969075, '홍제1동': 3298.3739837398375, '홍제3동': 3946.913580246913, '홍제2동': 1363.8095238095239, '홍은1동': 1394.3037974683543, '홍은2동': 2140.2912621359224, '남가좌1동': 3127.450980392157, '남가좌2동': 4636.363636363636, '북가좌1동': 5561.538461538461, '북가좌2동': 7788.0952380952385, '충현동': 21749.10714285714, '북아현동': 4067.391304347826, '신촌동': 11930.03802281369, '연희동': 3167.5409836065573, '용강동': 20955.95238095238, '대흥동': 9797.727272727272, '염리동': 7432.558139534884, '신수동': 6266.666666666666, '서교동': 30718.78787878788, '합정동': 7983.431952662722, '망원1동': 3468.421052631579, '망원2동': 7000.0, '연남동': 7147.692307692308, '성산1동': 13126.25, '성산2동': 5369.565217391305, '상암동': 4206.785714285714, '도화동': 22741.93548387097, '서강동': 7096.551724137931, '공덕동': 17311.881188118812, '아현동': 15419.736842105263, '목1동': 12746.099290780143, '목2동': 3534.9514563106795, '목3동': 7796.226415094339, '목4동': 5800.000000000001, '신월1동': 6969.230769230769, '신월2동': 6173.770491803279, '신월3동': 4583.908045977011, '신월4동': 6523.076923076923, '신월5동': 5907.246376811595, '신월6동': 7500.0, '신월7동': 4511.764705882353, '신정1동': 6157.142857142858, '신정2동': 5896.153846153846, '신정3동': 3302.205882352941, '신정6동': 5782.291666666667, '신정7동': 3346.280991735537, '목5동': 5139.226519337017, '신정4동': 13358.415841584158, '염창동': 8396.551724137931, '등촌1동': 24825.42372881356, '등촌2동': 3408.695652173913, '등촌3동': 25874.683544303796, '화곡본동': 3102.7027027027025, '화곡2동': 5568.085106382979, '화곡3동': 9000.0, '화곡4동': 4040.2439024390246, '화곡6동': 8351.785714285714, '화곡8동': 5288.679245283019, '가양1동': 2784.4680851063827, '가양2동': 3285.0, '가양3동': 7509.090909090909, '발산1동': 3661.1486486486488, '공항동': 3153.909843606256, '방화1동': 8927.884615384615, '방화2동': 1891.575663026521, '방화3동': 1869.747899159664, '화곡1동': 7803.5714285714275, '우장산동': 4922.058823529412, '신도림동': 8854.421768707483, '구로1동': 2769.607843137255, '구로3동': 77734.3137254902, '구로4동': 9013.04347826087, '구로5동': 24074.757281553397, '고척1동': 7310.344827586207, '고척2동': 3469.607843137255, '개봉2동': 3170.0, '개봉3동': 5911.11111111111, '오류1동': 7781.355932203391, '오류2동': 1587.1739130434785, '수궁동': 2078.2771535580523, '가리봉동': 5932.5, '구로2동': 16421.022727272728, '개봉1동': 3673.2824427480914, '가산동': 59080.95238095238, '독산1동': 11103.349282296651, '독산2동': 5283.333333333334, '독산3동': 8194.565217391304, '독산4동': 5235.593220338983, '시흥1동': 7056.725146198831, '시흥2동': 1523.8095238095239, '시흥3동': 9648.598130841121, '시흥4동': 2017.2413793103449, '시흥5동': 2115.8273381294966, '여의동': 16984.423305588585, '당산1동': 23205.333333333332, '당산2동': 12949.677419354839, '양평1동': 25836.363636363636, '양평2동': 6265.666666666667, '신길1동': 9343.939393939394, '신길3동': 5062.5, '신길4동': 4440.0, '신길5동': 5887.234042553192, '신길6동': 6017.647058823529, '신길7동': 3625.0, '대림1동': 7642.857142857143, '대림2동': 6589.090909090909, '대림3동': 10441.0, '영등포본동': 4682.35294117647, '영등포동': 27265.873015873014, '도림동': 3431.4606741573034, '문래동': 26245.637583892618, '노량진2동': 8660.9375, '상도1동': 4636.423841059603, '상도2동': 3945.918367346939, '상도3동': 3886.666666666667, '상도4동': 3409.3333333333335, '사당1동': 10549.367088607594, '사당3동': 4313.043478260869, '사당4동': 4026.315789473684, '사당5동': 2722.8070175438597, '대방동': 7190.967741935484, '신대방1동': 6312.903225806452, '신대방2동': 22441.747572815533, '흑석동': 5300.5952380952385, '노량진1동': 4518.354430379746, '사당2동': 1645.090909090909, '보라매동': 7568.421052631579, '청림동': 3470.0, '행운동': 7476.38888888889, '낙성대동': 2634.8017621145373, '중앙동': 11192.307692307691, '인헌동': 3286.111111111111, '남현동': 1294.4954128440368, '서원동': 9526.153846153846, '신원동': 3859.9999999999995, '서림동': 2846.4646464646466, '신사동': 12321.164021164022, '신림동': 6959.259259259259, '난향동': 2275.0, '조원동': 9114.925373134327, '대학동': 1262.289156626506, '은천동': 8575.641025641025, '성현동': 4101.470588235294, '청룡동': 8257.627118644068, '난곡동': 2242.7083333333335, '삼성동': 809.0225563909775, '미성동': 3994.9275362318845, '서초1동': 19738.732394366198, '서초2동': 36548.3870967742, '서초3동': 23754.607508532423, '서초4동': 27018.18181818182, '잠원동': 8540.90909090909, '반포본동': 2373.267326732673, '반포1동': 7999.0, '반포2동': 1965.9259259259259, '반포3동': 4627.34375, '반포4동': 19092.30769230769, '방배본동': 14162.686567164179, '방배1동': 19857.14285714286, '방배2동': 8179.274611398964, '방배3동': 5633.75, '방배4동': 13497.959183673469, '양재1동': 7703.819444444444, '양재2동': 6275.98944591029, '내곡동': 719.3217665615142, '논현1동': 32211.2, '논현2동': 38104.08163265306, '삼성1동': 31763.40206185567, '삼성2동': 29600.0, '대치1동': 7889.873417721518, '대치4동': 34041.09589041096, '역삼1동': 57266.3829787234, '역삼2동': 32380.869565217396, '도곡1동': 15802.941176470587, '도곡2동': 20949.019607843136, '개포1동': 1232.283464566929, '개포4동': 7683.892617449665, '일원본동': 3104.263565891473, '일원1동': 7313.043478260869, '일원2동': 7944.354838709677, '수서동': 10559.44055944056, '세곡동': 757.3899371069182, '압구정동': 10147.03557312253, '청담동': 15089.69957081545, '대치2동': 27251.0, '개포2동': 1180.4780876494026, '풍납1동': 2849.3506493506493, '풍납2동': 9369.182389937107, '거여1동': 5392.156862745098, '거여2동': 7184.905660377358, '마천1동': 3327.586206896552, '마천2동': 4494.38202247191, '방이1동': 23780.0, '방이2동': 24261.25, '오륜동': 1239.4321766561513, '오금동': 9519.39393939394, '송파1동': 16143.037974683544, '송파2동': 10756.603773584906, '석촌동': 13183.157894736843, '삼전동': 14465.263157894737, '가락본동': 23684.95575221239, '가락1동': 7719.4029850746265, '가락2동': 10125.0, '문정1동': 14974.999999999998, '문정2동': 10338.181818181818, '장지동': 7124.817518248175, '위례동': 957.2549019607844, '잠실본동': 20277.659574468085, '잠실4동': 1163.4615384615383, '잠실6동': 13103.94265232975, '잠실7동': 1891.6666666666667, '잠실2동': 1906.880733944954, '잠실3동': 5152.3489932885905, '강일동': 5202.857142857143, '상일동': 1782.2641509433963, '명일1동': 8431.147540983608, '명일2동': 4090.721649484536, '고덕1동': 1068.208092485549, '고덕2동': 1486.0696517412937, '암사2동': 3947.4576271186443, '암사3동': 750.996015936255, '천호1동': 7005.633802816902, '천호3동': 8379.746835443038, '성내1동': 29644.8275862069, '성내2동': 9705.970149253732, '성내3동': 11135.211267605635, '둔촌1동': 1460.8695652173913, '둔촌2동': 8769.387755102041, '암사1동': 4747.058823529412, '천호2동': 7578.980891719745, '길동': 7399.539170506912}
for i in [may_df]:
    i['buss_density']=i['행정동'].map(buss_dict)
may_df.head()
may_df.to_excel("MAYtotal_origin.xls", index=False)

#모든 변수 StandardScaler로 정규화
from sklearn.preprocessing import StandardScaler
z_scaler = StandardScaler().fit(may_df[list(may_df.columns[3:27])])
z_mat = z_scaler.transform(may_df[list(may_df.columns[3:27])])
z_mat

#np.array형태의 정규화 결과를 DataFrame에 컬럼으로 추가해주기
may_df.columns[3:27]
may_df['N_weekday_mean'] = z_mat[:,0:1]
may_df['N_fri_temp'] = z_mat[:,1:2]
may_df['N_fri_rain'] = z_mat[:,2:3]
may_df['N_sat_temp'] = z_mat[:,3:4]
may_df['N_sat_rain'] = z_mat[:,4:5]
may_df['N_sun_temp'] = z_mat[:,5:6]
may_df['N_sun_rain'] = z_mat[:,6:7]
may_df['N_fri_미세'] = z_mat[:,7:8]
may_df['N_fri_초미세'] = z_mat[:,8:9]
may_df['N_sat_미세'] = z_mat[:,9:10]
may_df['N_sat_초미세'] = z_mat[:,10:11]
may_df['N_sun_미세'] = z_mat[:,11:12]
may_df['N_sun_초미세'] = z_mat[:,12:13]
may_df['N_foodindustry'] = z_mat[:,13:14]
may_df['N_population_density'] = z_mat[:,14:15]
may_df['N_buss_density'] = z_mat[:,15:16]
may_df['N_univ_num'] = z_mat[:,16:17]
may_df['N_trend_thu'] = z_mat[:,17:18]
may_df['N_trend_fri'] = z_mat[:,18:19]
may_df['N_trend_sat'] = z_mat[:,19:20]
may_df['N_trend_sun'] = z_mat[:,20:21]
may_df['N_pop_fri'] = z_mat[:,21:22]
may_df['N_pop_sat'] = z_mat[:,22:23]
may_df['N_pop_sun'] = z_mat[:,23:24]
may_df.head()

#정규화 이전 변수 삭제하기
may_df2 = may_df.drop(['weekday_mean', 'fri_temp', 'fri_rain', 'sat_temp', 'sat_rain',
       'sun_temp', 'sun_rain', 'fri_미세', 'fri_초미세', 'sat_미세', 'sat_초미세',
       'sun_미세', 'sun_초미세', 'foodindustry', 'population_density',
       'buss_density', 'univ_num', 'trend_thu', 'trend_fri', 'trend_sat',
       'trend_sun', 'pop_fri', 'pop_sat', 'pop_sun'], axis=1)
may_df2.head()
may_df2.to_excel("MAYtotal_standard.xls", index=False)
